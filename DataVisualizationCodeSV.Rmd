---
title: "DataVisualizationCodeSV"
author: "Saulai Vue"
date: "2025-05-15"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyr)
library(tidyverse)
library(rvest) #web scraping package and working with html
library(tidytext) #converts text into tidy format, and text mining
library(httr)    #sends http requests and working with web API
library(stringr) #working with strings into tidyverse and cleaning text strings
library(readr)
library(ggplot2)
library(gganimate)
```


## Import Main Data Frame

```{r}
lyrics_final_df_url <- "https://raw.githubusercontent.com/vsaulai/STAT-345-FinalProject-Lyrics/refs/heads/main/final_lyrics_df.csv"
lyrics_df <- read.csv(lyrics_final_df_url)
View(lyrics_df)
```

## Function to Remove all NA values in Lyrics

```{r}
delete_na_rows <- function(df, column_name) {
  # Check if the column exists
  if (!column_name %in% names(df)) {
    stop("The specified column does not exist in the data frame.")
  }
  
  # Remove rows where the specified column is NA or blank
  df_clean <- df[!is.na(df[[column_name]]) & df[[column_name]] != "", ]
  
  return(df_clean)
}
```

## Run Previous Function

```{r}
lyrics_df_remove_na <- delete_na_rows(lyrics_df, "lyrics")

```

## Remove Unnecessary Columns

```{r}
lyrics_df_remove_na <- lyrics_df_remove_na[ , !(names(lyrics_df_remove_na) %in% c("url", "phrase_repetition", "title_repetition_count"))] # deleting url, phrase_repetition, and title_repetition columns
```

## Average Word Count List (Floating Point)

```{r}
yearly_averages <- lyrics_df_remove_na %>%
  group_by(Year) %>%
  summarize(
    avg_word_count = mean(word_count, na.rm = TRUE),
    avg_adjective = mean(adjective, na.rm = TRUE),
    avg_adposition = mean(adposition, na.rm = TRUE),
    avg_adverb = mean(adverb, na.rm = TRUE),
    avg_AUX = mean(AUX, na.rm = TRUE),
    avg_coordinating_conj = mean(coordinating_conj, na.rm = TRUE),
    avg_determiner = mean(determiner, na.rm = TRUE),
    avg_interjection = mean(interjection, na.rm = TRUE),
    avg_noun = mean(noun, na.rm = TRUE),
    avg_numeral = mean(numeral, na.rm = TRUE),
    avg_particle = mean(particle, na.rm = TRUE),
    avg_pronoun = mean(pronoun, na.rm = TRUE),
    avg_proper_noun = mean(proper_noun, na.rm = TRUE),
    avg_verb = mean(verb, na.rm = TRUE),
    avg_punctuation = mean(punctuation, na.rm = TRUE),
    avg_subordinating_conj = mean(subordinating_conj, na.rm = TRUE),
    avg_NA = mean(`NA.`, na.rm = TRUE),
    avg_other = mean(other, na.rm = TRUE),
    avg_symbol = mean(symbol, na.rm = TRUE),
    .groups = 'drop'
  )

```


## Average Word Count List (Rounded up to Two Decimal Points)

```{r}
yearly_averages_rounded <- lyrics_df_remove_na %>%
  group_by(Year) %>%
  summarize(
    avg_word_count = round(mean(word_count, na.rm = TRUE), 2),
    avg_adjective = round(mean(adjective, na.rm = TRUE), 2),
    avg_adposition = round(mean(adposition, na.rm = TRUE), 2),
    avg_adverb = round(mean(adverb, na.rm = TRUE), 2),
    avg_AUX = round(mean(AUX, na.rm = TRUE), 2),
    avg_coordinating_conj = round(mean(coordinating_conj, na.rm = TRUE), 2),
    avg_determiner = round(mean(determiner, na.rm = TRUE), 2),
    avg_interjection = round(mean(interjection, na.rm = TRUE), 2),
    avg_noun = round(mean(noun, na.rm = TRUE), 2),
    avg_numeral = round(mean(numeral, na.rm = TRUE), 2),
    avg_particle = round(mean(particle, na.rm = TRUE), 2),
    avg_pronoun = round(mean(pronoun, na.rm = TRUE), 2),
    avg_proper_noun = round(mean(proper_noun, na.rm = TRUE), 2),
    avg_verb = round(mean(verb, na.rm = TRUE), 2),
    avg_punctuation = round(mean(punctuation, na.rm = TRUE), 2),
    avg_subordinating_conj = round(mean(subordinating_conj, na.rm = TRUE), 2),
    avg_NA = round(mean(`NA.`, na.rm = TRUE), 2),
    avg_other = round(mean(other, na.rm = TRUE), 2),
    avg_symbol = round(mean(symbol, na.rm = TRUE), 2),
    .groups = 'drop'
  )
```



```{r}
combined_averages <- list()

# Loop over the names (e.g., years) in the lists
for (Year in names(yearly_averages)) {
  combined_averages[[Year]] <- list(
    unrounded = yearly_averages[[Year]],
    rounded = yearly_averages_rounded[[Year]]
  )
}

```


## Splitting into Periods by Decades into A List

1958-1969, 1970-1979, 1980-1989, 1990-1999, 2000-2009, 2010-2019, 2020-2024.

```{r}
# Create a list of named intervals
year_intervals <- list(
  "1958_1969" = c(1958, 1969),
  "1970_1979" = c(1970, 1979),
  "1980_1989" = c(1980, 1989),
  "1990_1999" = c(1990, 1999),
  "2000_2009" = c(2000, 2009),
  "2010_2019" = c(2010, 2019),
  "2020_2024" = c(2020, 2024)
)

# Create a list to hold the split data frames
split_years <- list()

# For Loop to Split Years into Desired intervals
for (name in names(year_intervals)) {
  range <- year_intervals[[name]]
  start <- range[1]
  end <- range[2]
  
  # Filter the data for this range
  df_range <- subset(lyrics_df_remove_na, Year >= start & Year <= end)
  
  # Save to environment and list
  assign(paste0("lyrics_", name), df_range, envir = .GlobalEnv)
  split_years[[paste0("lyrics_", name)]] <- df_range
}

```



```{r}
View(lyrics_1958_1969)
View(lyrics_1970_1979)
View(lyrics_1980_1989)
View(lyrics_1990_1999)
View(lyrics_2000_2009)
View(lyrics_2010_2019)
View(lyrics_2020_2024)
View(yearly_averages)
View(yearly_averages_rounded)
```

